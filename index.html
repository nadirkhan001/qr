<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.min.js"></script>
</head>
<body>
    <h1>Scan QR Code</h1>
    <video id="video" width="300" height="200" autoplay></video>
    <p id="output"></p>
    <script>
        // Start the camera and QR code scanner
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } }).then(stream => {
            const video = document.getElementById("video");
            video.srcObject = stream;

            const canvas = document.createElement("canvas");
            const context = canvas.getContext("2d");

            video.addEventListener("play", () => {
                setInterval(() => {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const code = jsQR(imageData.data, imageData.width, imageData.height);

                    if (code) {
                        const scannedData = code.data;
                        document.getElementById("output").innerText = `Scanned: ${scannedData}`;
                        
                        // Send the scanned data to Adalo
                        sendToAdalo(scannedData);
                    }
                }, 100);
            });
        });

        // Function to send scanned QR code data to Adalo
        function sendToAdalo(data) {
            fetch("https://api.adalo.com/v0/apps/<APP_ID>/collections/<COLLECTION_ID>", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer <YOUR_API_KEY>"
                },
                body: JSON.stringify({
                    "field_name": data // Replace 'field_name' with your Adalo collection's field key
                })
            })
            .then(response => {
                if (response.ok) {
                    console.log("Data successfully sent to Adalo");
                } else {
                    console.error("Failed to send data to Adalo");
                }
            })
            .catch(error => {
                console.error("Error sending data to Adalo:", error);
            });
        }
    </script>
</body>
</html>
